import{a as F}from"./chunk-D772OIOF.js";import{a as Se}from"./chunk-PHAMOGVT.js";import{N as _e,c as le,d as de,g as D,k as V,p as ue,q as ge,s as he,t as fe,u as ve}from"./chunk-SZOBYU5N.js";import{$ as v,B as K,C as k,Cb as z,E as X,Fb as ce,Gb as me,H as f,Ha as s,Hb as G,I as M,Ia as b,Ja as P,Ka as te,La as ie,Ma as ne,N as d,Na as oe,O as u,R as Y,Ra as W,Va as E,Wa as O,Z as N,_ as a,ib as re,ja as h,jb as y,k as w,la as c,m as T,na as $,pa as o,pb as B,qa as r,qb as ae,ra as _,sa as Z,ta as ee,tb as se,ub as pe,va as S,ya as l,za as m}from"./chunk-BFXX2XRG.js";var x=class{brandId=0;typeId=0;sort="name";pageNumber=1;pageSize=6;search=""};var j=class{pageIndex;pageSize;count;data=[]};var I=class i{constructor(t){this.http=t}baseUrl=le.apiUrl;products=[];brands=[];types=[];pagination=new j;shopParams=new x;getProducts(t){if(t===!1&&(this.products=[]),this.products.length>0&&t===!0){let n=Math.ceil(this.products.length/this.shopParams.pageSize);if(this.shopParams.pageNumber<=n)return this.pagination.data=this.products.slice((this.shopParams.pageNumber-1)*this.shopParams.pageSize,this.shopParams.pageNumber*this.shopParams.pageSize),w(this.pagination)}let e=new se;return this.shopParams.brandId!==0&&(e=e.append("brandId",this.shopParams.brandId.toString())),this.shopParams.typeId!==0&&(e=e.append("typeId",this.shopParams.typeId.toString())),this.shopParams.search&&(e=e.append("search",this.shopParams.search)),e=e.append("sort",this.shopParams.sort),e=e.append("pageIndex",this.shopParams.pageNumber.toString()),e=e.append("pageSize",this.shopParams.pageSize.toString()),this.http.get(this.baseUrl+"products",{observe:"response",params:e}).pipe(T(n=>(this.products=[...this.products,...n.body?.data||[]],n.body&&(this.pagination=n.body),this.pagination)))}setShopParams(t){this.shopParams=t}getShopParams(){return this.shopParams}getProduct(t){let e=this.products.find(n=>n.id===t);return e?w(e):this.http.get(this.baseUrl+"products/"+t)}getBrands(){return this.brands.length>0?w(this.brands):this.http.get(this.baseUrl+"products/brands").pipe(T(t=>(this.brands=t,t)))}getTypes(){return this.types.length>0?w(this.types):this.http.get(this.baseUrl+"products/types").pipe(T(t=>(this.types=t,t)))}static \u0275fac=function(e){return new(e||i)(X(pe))};static \u0275prov=K({token:i,factory:i.\u0275fac,providedIn:"root"})};function xe(i,t){if(i&1&&(o(0,"span"),s(1," Showing "),o(2,"strong"),s(3),r(),s(4," of "),o(5,"strong"),s(6),r(),s(7," Results "),r()),i&2){let e=m();a(3),te(" ",(e.pageNumber-1)*e.pageSize+1," - ",e.pageNumber*e.pageSize>e.totalCount?e.totalCount:e.pageNumber*e.pageSize," "),a(3),P(" ",e.totalCount," ")}}function Ie(i,t){i&1&&(o(0,"span"),s(1," There are "),o(2,"strong"),s(3,"0"),r(),s(4," results for this filter "),r())}var R=class i{pageNumber;pageSize;totalCount;static \u0275fac=function(e){return new(e||i)};static \u0275cmp=f({type:i,selectors:[["app-paging-header"]],inputs:{pageNumber:"pageNumber",pageSize:"pageSize",totalCount:"totalCount"},decls:3,vars:2,consts:[[4,"ngIf"]],template:function(e,n){e&1&&(o(0,"header"),h(1,xe,8,3,"span",0)(2,Ie,5,0,"span",0),r()),e&2&&(a(),c("ngIf",n.totalCount&&n.totalCount>0),a(),c("ngIf",n.totalCount===0))},dependencies:[y]})};var H=class i{totalCount=0;pageSize=0;pageNumber;pageChanged=new Y;onPagerChange(t){this.pageChanged.emit(t.page)}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=f({type:i,selectors:[["app-pager"]],inputs:{totalCount:"totalCount",pageSize:"pageSize",pageNumber:"pageNumber"},outputs:{pageChanged:"pageChanged"},decls:1,vars:4,consts:[["previousText","\u2039","nextText","\u203A","firstText","\xAB","lastText","\xBB",3,"pageChanged","boundaryLinks","totalItems","ngModel","itemsPerPage"]],template:function(e,n){e&1&&(o(0,"pagination",0),l("pageChanged",function(g){return n.onPagerChange(g)}),r()),e&2&&c("boundaryLinks",!0)("totalItems",n.totalCount)("ngModel",n.pageNumber)("itemsPerPage",n.pageSize)},dependencies:[fe,D,V]})};var Ce=i=>["/shop/",i],L=class i{constructor(t){this.basketService=t}product;addItemToBasket(){this.basketService.addItemToBasket(this.product)}static \u0275fac=function(e){return new(e||i)(v(F))};static \u0275cmp=f({type:i,selectors:[["app-product-item"]],inputs:{product:"product"},decls:15,vars:12,consts:[[1,"card","h-100","shadow-sm"],[1,"image","position-relative",2,"cursor","pointer"],[1,"img-fluid","bg-light","p-3","rounded-top",2,"object-fit","cover",3,"src","alt"],[1,"d-flex","align-items-center","justify-content-center","hover-overlay"],["type","button",1,"btn","btn-primary",3,"click"],[1,"fa","fa-shopping-cart"],["routerLinkActive","router-link-active","type","button",1,"btn","btn-primary",3,"routerLink"],[1,"card-body","d-flex","flex-column","text-center"],[1,"text-decoration-none",3,"routerLink"],[1,"text-uppercase","fw-bold"],[1,"mb-2","text-muted"]],template:function(e,n){e&1&&(o(0,"div",0)(1,"div",1),_(2,"img",2),o(3,"div",3)(4,"button",4),l("click",function(){return n.addItemToBasket()}),_(5,"i",5),r(),o(6,"button",6),s(7," View "),r()()(),o(8,"div",7)(9,"a",8)(10,"h6",9),s(11),r()(),o(12,"span",10),s(13),E(14,"currency"),r()()()),e&2&&(a(2),c("src",n.product.pictureUrl,N)("alt",n.product.name),a(4),c("routerLink",W(8,Ce,n.product.id)),a(3),c("routerLink",W(10,Ce,n.product.id)),a(2),b(n.product.name),a(2),b(O(14,6,n.product.price)))},dependencies:[ce,me,B],styles:[".btn[_ngcontent-%COMP%]{width:20%;height:2.5rem}.image[_ngcontent-%COMP%]{position:relative;cursor:pointer}.image[_ngcontent-%COMP%]:hover   .hover-overlay[_ngcontent-%COMP%]{opacity:1}.image[_ngcontent-%COMP%]:hover   .hover-overlay[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{transform:translate(0);opacity:1}.hover-overlay[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%;top:0;left:0;background:#ffffff80;opacity:0;transition:opacity .3s ease-in-out}.hover-overlay[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{z-index:1000;opacity:0;transition:transform .3s ease-in-out,opacity .2s ease-in-out}.hover-overlay[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:first-of-type{transform:translate(-1.25rem);margin-right:.5rem}.hover-overlay[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:last-of-type{transform:translate(1.25rem);margin-left:.5rem}"]})};function Ee(i,t){if(i&1&&(o(0,"option",15),s(1),r()),i&2){let e=t.$implicit,n=m(2);c("selected",n.shopParams.sort===e.value)("value",e.value),a(),P(" ",e.name," ")}}function Oe(i,t){if(i&1){let e=S();o(0,"li",16),l("click",function(){let p=d(e).$implicit,g=m(2);return u(g.onBrandSelected(p.id))}),s(1),r()}if(i&2){let e=t.$implicit,n=m(2);$("active",e.id===n.shopParams.brandId),c("value",e.id),a(),P(" ",e.name," ")}}function Be(i,t){if(i&1){let e=S();o(0,"li",16),l("click",function(){let p=d(e).$implicit,g=m(2);return u(g.onTypeSelected(p.id))}),s(1),r()}if(i&2){let e=t.$implicit,n=m(2);$("active",e.id===n.shopParams.typeId),c("value",e.id),a(),P(" ",e.name," ")}}function ze(i,t){if(i&1){let e=S();Z(0),o(1,"h5",9),s(2,"Sort"),r(),o(3,"select",10),l("change",function(p){d(e);let g=m();return u(g.onSortSelected(p))}),h(4,Ee,2,3,"option",11),r(),o(5,"h5",12),s(6,"Brands"),r(),o(7,"ul",13),h(8,Oe,2,4,"li",14),r(),o(9,"h5",12),s(10,"Types"),r(),o(11,"ul",13),h(12,Be,2,4,"li",14),r(),ee()}if(i&2){let e=m();a(4),c("ngForOf",e.sortOptions),a(4),c("ngForOf",e.brands),a(4),c("ngForOf",e.types)}}function De(i,t){if(i&1){let e=S();o(0,"div",17)(1,"div",18),_(2,"app-paging-header",19),r(),o(3,"div",20)(4,"input",21),l("keyup.enter",function(){d(e);let p=m();return u(p.onSearch())}),oe("ngModelChange",function(p){d(e);let g=m();return ne(g.searchTerm,p)||(g.searchTerm=p),u(p)}),r(),o(5,"button",22),l("click",function(){d(e);let p=m();return u(p.onSearch())}),s(6,"Search"),r(),o(7,"button",23),l("click",function(){d(e);let p=m();return u(p.onReset())}),s(8,"Reset"),r()()()}if(i&2){let e=m();a(2),c("totalCount",e.totalCount)("pageSize",e.shopParams.pageSize)("pageNumber",e.shopParams.pageNumber),a(2),ie("ngModel",e.searchTerm)}}function Ve(i,t){if(i&1&&(o(0,"div",24),_(1,"app-product-item",25),r()),i&2){let e=t.$implicit;a(),c("product",e)}}function Fe(i,t){if(i&1){let e=S();o(0,"div",26)(1,"app-pager",27),l("pageChanged",function(p){d(e);let g=m();return u(g.onPageChanged(p))}),r()()}if(i&2){let e=m();a(),c("pageSize",e.shopParams.pageSize)("totalCount",e.totalCount)("pageNumber",e.shopParams.pageNumber)}}var U=class i{constructor(t,e){this.shopService=t;this.route=e;this.shopParams=t.getShopParams()}products;brands;types;shopParams;totalCount=20;searchTerm="";sortOptions=[{name:"Alphabetical",value:"name"},{name:"Price: Low to High",value:"priceAsc"},{name:"Price: High to Low",value:"priceDesc"}];ngOnInit(){this.route.queryParams.subscribe(t=>{let e=this.shopParams.brandId,n=this.shopParams.typeId;this.shopParams.brandId=t.brandId?+t.brandId:0,this.shopParams.typeId=t.typeId?+t.typeId:0,e!==this.shopParams.brandId||n!==this.shopParams.typeId?(this.shopParams.pageNumber=1,this.getProducts(!1)):this.getProducts(!0),this.shopService.setShopParams(this.shopParams)}),this.getBrands(),this.getTypes()}getProducts(t=!1){this.shopService.getProducts(t).subscribe(e=>{e&&(this.products=e.data,this.totalCount=e.count)},e=>{console.log(e)})}getBrands(){this.shopService.getBrands().subscribe(t=>{this.brands=[{id:0,name:"All"},...t]},t=>{console.log(t)})}getTypes(){this.shopService.getTypes().subscribe(t=>{this.types=[{id:0,name:"All"},...t]},t=>{console.log(t)})}onBrandSelected(t){let e=this.shopService.getShopParams();e.brandId=t,e.pageNumber=1,this.shopService.setShopParams(e),this.getProducts()}onTypeSelected(t){let e=this.shopService.getShopParams();e.typeId=t,e.pageNumber=1,this.shopService.setShopParams(e),this.getProducts()}onSortSelected(t){let e=this.shopService.getShopParams(),n=t.target.value;e.sort=n,this.shopService.setShopParams(e),this.getProducts()}onPageChanged(t){let e=this.shopService.getShopParams();e.pageNumber!==t&&(e.pageNumber=t,this.shopService.setShopParams(e),this.getProducts(!0))}onSearch(){let t=this.shopService.getShopParams();t.search=this.searchTerm,t.pageNumber=1,this.shopService.setShopParams(t),this.getProducts()}onReset(){this.searchTerm="",this.shopParams=new x,this.shopService.setShopParams(this.shopParams),this.getProducts()}static \u0275fac=function(e){return new(e||i)(v(I),v(z))};static \u0275cmp=f({type:i,selectors:[["app-shop"]],decls:9,vars:4,consts:[[1,"container","mt-3"],[1,"row"],[1,"col-12","col-lg-3","mb-4","mb-lg-0"],[4,"ngIf"],[1,"col-12","col-lg-9","my-3"],["class","d-flex flex-column flex-md-row justify-content-between align-items-start align-items-md-center gap-3 pb-3",4,"ngIf"],[1,"row","row-cols-1","row-cols-sm-2","row-cols-md-3","g-4","mt-1"],["class","col d-flex",4,"ngFor","ngForOf"],["class","d-flex justify-content-center mt-4",4,"ngIf"],[1,"text-primary","ms-2","mt-4","mb-3"],[1,"form-select","mb-4",3,"change"],[3,"selected","value",4,"ngFor","ngForOf"],[1,"text-primary","ms-2"],[1,"list-group","my-3"],["class","list-group-item",3,"active","value","click",4,"ngFor","ngForOf"],[3,"selected","value"],[1,"list-group-item",3,"click","value"],[1,"d-flex","flex-column","flex-md-row","justify-content-between","align-items-start","align-items-md-center","gap-3","pb-3"],[1,"flex-grow-1"],[3,"totalCount","pageSize","pageNumber"],[1,"d-flex","flex-column","flex-sm-row","align-items-stretch","gap-2"],["placeholder","Search","type","text",1,"form-control",3,"keyup.enter","ngModelChange","ngModel"],[1,"btn","btn-outline-primary",3,"click"],[1,"btn","btn-outline-success",3,"click"],[1,"col","d-flex"],[1,"w-100",3,"product"],[1,"d-flex","justify-content-center","mt-4"],[3,"pageChanged","pageSize","totalCount","pageNumber"]],template:function(e,n){e&1&&(o(0,"div",0)(1,"div",1)(2,"section",2),h(3,ze,13,3,"ng-container",3),r(),o(4,"section",4),h(5,De,9,4,"div",5),o(6,"div",6),h(7,Ve,2,1,"div",7),r(),h(8,Fe,2,3,"div",8),r()()()),e&2&&(a(3),c("ngIf",n.types&&n.brands),a(2),c("ngIf",n.products),a(2),c("ngForOf",n.products),a(),c("ngIf",n.totalCount&&n.totalCount>0&&n.products))},dependencies:[re,y,R,H,ue,ge,de,D,V,L],styles:[".list-group-item[_ngcontent-%COMP%]{cursor:pointer;border:none;padding:10px 20px;font-size:1.1em}.list-group-item[_ngcontent-%COMP%]:focus{outline:none}.list-group-item.active[_ngcontent-%COMP%]{border-radius:10px}.list-group-item[_ngcontent-%COMP%]:not(.active):hover{color:#fff;background-color:#0d6dfd80;border-radius:10px}"]})};function je(i,t){if(i&1){let e=S();o(0,"div",2)(1,"div",3),_(2,"img",4),r(),o(3,"div",3)(4,"h3",5),s(5),r(),o(6,"p",6),s(7),E(8,"currency"),r(),o(9,"div",7)(10,"i",8),l("click",function(){d(e);let p=m();return u(p.decrementQuantity())}),r(),o(11,"span",9),s(12),r(),o(13,"i",10),l("click",function(){d(e);let p=m();return u(p.incrementQuantity())}),r(),o(14,"button",11),l("click",function(){d(e);let p=m();return u(p.addItemToBasket())}),s(15,"Add to Cart"),r()()(),o(16,"div",12)(17,"h4",13),s(18,"Description"),r(),o(19,"p",14),s(20),r()()()}if(i&2){let e=m();a(2),c("src",e.product.pictureUrl,N)("alt",e.product.name),a(3),b(e.product.name),a(2),b(O(8,6,e.product.price)),a(5),b(e.quantity),a(8),b(e.product.description)}}var q=class i{constructor(t,e,n,p){this.shopService=t;this.activeRoute=e;this.bcService=n;this.basketService=p;this.bcService.set("@productDetails"," ")}product;quantity=1;ngOnInit(){this.loadProduct()}addItemToBasket(){this.basketService.addItemToBasket(this.product,this.quantity)}incrementQuantity(){this.quantity++}decrementQuantity(){this.quantity>1&&this.quantity--}loadProduct(){let t=this.activeRoute.snapshot.params.id;this.shopService.getProduct(t).subscribe(e=>{this.product=e,this.bcService.set("@productDetails",e.name)},e=>{console.log(e)})}static \u0275fac=function(e){return new(e||i)(v(I),v(z),v(Se),v(F))};static \u0275cmp=f({type:i,selectors:[["app-product-details"]],decls:2,vars:1,consts:[[1,"container","mt-5"],["class","row g-4",4,"ngIf"],[1,"row","g-4"],[1,"col-md-6"],[1,"img-fluid","w-100","rounded","shadow-sm",3,"src","alt"],[1,"fw-bold"],[1,"text-muted","fs-4"],[1,"d-flex","align-items-center","gap-3"],[1,"fa","fa-minus-circle","text-warning",2,"cursor","pointer","font-size","2em",3,"click"],[1,"fw-bold","fs-4"],[1,"fa","fa-plus-circle","text-warning",2,"cursor","pointer","font-size","2em",3,"click"],[1,"btn","btn-outline-primary","btn-lg","ms-4",3,"click"],[1,"col-12"],[1,"fw-semibold"],[1,"text-secondary"]],template:function(e,n){e&1&&(o(0,"div",0),h(1,je,21,8,"div",1),r()),e&2&&(a(),c("ngIf",n.product))},dependencies:[y,B]})};var Re=[{path:"",component:U},{path:":id",component:q,data:{breadcrumb:{alias:"productDetails"}}}],Q=class i{static \u0275fac=function(e){return new(e||i)};static \u0275mod=M({type:i});static \u0275inj=k({imports:[G.forChild(Re),G]})};var ye=class i{static \u0275fac=function(e){return new(e||i)};static \u0275mod=M({type:i});static \u0275inj=k({imports:[ae,_e,ve.forRoot(),he,Q]})};export{ye as ShopModule};
